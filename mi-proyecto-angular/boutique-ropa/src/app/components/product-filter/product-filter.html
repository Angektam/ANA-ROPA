<div class="product-filter">
  <!-- Filter Header -->
  <div class="filter-header">
    <div class="header-content">
      <h3 class="filter-main-title">
        <i class="fas fa-filter"></i>
        Filtros Avanzados
      </h3>
      <div class="filter-stats" *ngIf="hasActiveFilters()">
        <span class="active-count">{{ getActiveFiltersCount() }} filtros activos</span>
      </div>
    </div>
    <button class="btn-clear-all" *ngIf="hasActiveFilters()" (click)="clearFilters()">
      <i class="fas fa-times"></i>
      Limpiar Todo
    </button>
  </div>

  <!-- Filter Content -->
  <div class="filter-content">
    <!-- Filtro por Categoría -->
    <div class="filter-section">
      <div class="section-header" (click)="toggleSection('category')">
        <h4 class="filter-title">
          <i class="fas fa-tags"></i>
          <span>Categoría</span>
          <span class="filter-count" *ngIf="categories.length > 0">({{ categories.length }})</span>
        </h4>
        <i class="fas fa-chevron-down section-toggle" [class.rotated]="isSectionOpen('category')"></i>
      </div>
      <div class="filter-options" [class.collapsed]="!isSectionOpen('category')">
        <label class="filter-option radio-option">
          <input 
            type="radio" 
            name="category" 
            value="" 
            (change)="onCategoryChange('')"
            [checked]="!filters.category">
          <span class="option-content">
            <i class="fas fa-th-large"></i>
            <span>Todas las categorías</span>
          </span>
        </label>
        <label class="filter-option radio-option" *ngFor="let category of categories">
          <input 
            type="radio" 
            name="category" 
            [value]="category.slug" 
            (change)="onCategoryChange(category.slug)"
            [checked]="filters.category === category.slug">
          <span class="option-content">
            <i class="fas fa-tag"></i>
            <span>{{ category.name }}</span>
          </span>
        </label>
      </div>
    </div>

    <!-- Filtro por Precio -->
    <div class="filter-section">
      <div class="section-header" (click)="toggleSection('price')">
        <h4 class="filter-title">
          <i class="fas fa-dollar-sign"></i>
          <span>Rango de Precio</span>
        </h4>
        <i class="fas fa-chevron-down section-toggle" [class.rotated]="isSectionOpen('price')"></i>
      </div>
      <div class="filter-options" [class.collapsed]="!isSectionOpen('price')">
        <label class="filter-option radio-option">
          <input 
            type="radio" 
            name="priceRange" 
            value="" 
            (change)="onPriceRangeChange(null)"
            [checked]="!filters.priceRange">
          <span class="option-content">
            <i class="fas fa-infinity"></i>
            <span>Todos los precios</span>
          </span>
        </label>
        <label class="filter-option radio-option" *ngFor="let range of priceRanges">
          <input 
            type="radio" 
            name="priceRange" 
            [value]="range.min + '-' + range.max" 
            (change)="onPriceRangeChange(range)"
            [checked]="filters.priceRange?.min === range.min && filters.priceRange?.max === range.max">
          <span class="option-content">
            <i class="fas fa-tag"></i>
            <span>{{ range.label }}</span>
            <span class="price-range">{{ range.min | currency:'USD':'symbol':'1.0-0' }} - {{ range.max | currency:'USD':'symbol':'1.0-0' }}</span>
          </span>
        </label>
      </div>
    </div>

    <!-- Filtro por Talla -->
    <div class="filter-section" *ngIf="sizes.length > 0">
      <div class="section-header" (click)="toggleSection('size')">
        <h4 class="filter-title">
          <i class="fas fa-ruler"></i>
          <span>Talla</span>
          <span class="filter-count">({{ sizes.length }})</span>
        </h4>
        <i class="fas fa-chevron-down section-toggle" [class.rotated]="isSectionOpen('size')"></i>
      </div>
      <div class="filter-options" [class.collapsed]="!isSectionOpen('size')">
        <div class="size-grid">
          <label class="filter-option checkbox-option size-option" *ngFor="let size of sizes">
            <input 
              type="checkbox" 
              [value]="size" 
              (change)="onSizeChangeEvent($event)"
              [checked]="isSizeSelected(size)">
            <span class="option-content size-content">
              <span class="size-label">{{ size }}</span>
            </span>
          </label>
        </div>
      </div>
    </div>

    <!-- Filtro por Color -->
    <div class="filter-section" *ngIf="colors.length > 0">
      <div class="section-header" (click)="toggleSection('color')">
        <h4 class="filter-title">
          <i class="fas fa-palette"></i>
          <span>Color</span>
          <span class="filter-count">({{ colors.length }})</span>
        </h4>
        <i class="fas fa-chevron-down section-toggle" [class.rotated]="isSectionOpen('color')"></i>
      </div>
      <div class="filter-options" [class.collapsed]="!isSectionOpen('color')">
        <div class="color-grid">
          <label class="filter-option checkbox-option color-option" *ngFor="let color of colors">
            <input 
              type="checkbox" 
              [value]="color" 
              (change)="onColorChangeEvent($event)"
              [checked]="isColorSelected(color)">
            <span class="option-content color-content">
              <span class="color-circle" [class]="color.toLowerCase().replace(' ', '-')"></span>
              <span class="color-name">{{ color }}</span>
            </span>
          </label>
        </div>
      </div>
    </div>

    <!-- Filtro por Marca -->
    <div class="filter-section" *ngIf="brands.length > 0">
      <div class="section-header" (click)="toggleSection('brand')">
        <h4 class="filter-title">
          <i class="fas fa-crown"></i>
          <span>Marca</span>
          <span class="filter-count">({{ brands.length }})</span>
        </h4>
        <i class="fas fa-chevron-down section-toggle" [class.rotated]="isSectionOpen('brand')"></i>
      </div>
      <div class="filter-options" [class.collapsed]="!isSectionOpen('brand')">
        <label class="filter-option checkbox-option" *ngFor="let brand of brands">
          <input 
            type="checkbox" 
            [value]="brand" 
            (change)="onBrandChangeEvent($event)"
            [checked]="isBrandSelected(brand)">
          <span class="option-content">
            <i class="fas fa-certificate"></i>
            <span>{{ brand }}</span>
          </span>
        </label>
      </div>
    </div>

    <!-- Ordenamiento -->
    <div class="filter-section">
      <div class="section-header" (click)="toggleSection('sort')">
        <h4 class="filter-title">
          <i class="fas fa-sort"></i>
          <span>Ordenar por</span>
        </h4>
        <i class="fas fa-chevron-down section-toggle" [class.rotated]="isSectionOpen('sort')"></i>
      </div>
      <div class="filter-options" [class.collapsed]="!isSectionOpen('sort')">
        <div class="sort-container">
          <select class="sort-select" (change)="onSortChange($event)">
            <option value="">
              <i class="fas fa-star"></i>
              Recomendado
            </option>
            <option value="newest">
              <i class="fas fa-clock"></i>
              Más recientes
            </option>
            <option value="price-asc">
              <i class="fas fa-arrow-up"></i>
              Precio: menor a mayor
            </option>
            <option value="price-desc">
              <i class="fas fa-arrow-down"></i>
              Precio: mayor a menor
            </option>
            <option value="rating">
              <i class="fas fa-star"></i>
              Mejor valorados
            </option>
            <option value="name">
              <i class="fas fa-sort-alpha-down"></i>
              Nombre A-Z
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Footer -->
  <div class="filter-footer" *ngIf="hasActiveFilters()">
    <div class="active-filters">
      <span class="footer-label">Filtros activos:</span>
      <div class="active-tags">
        <span class="active-tag" *ngIf="filters.category">
          <i class="fas fa-tag"></i>
          {{ getCategoryName(filters.category) }}
          <button (click)="clearCategoryFilter()">
            <i class="fas fa-times"></i>
          </button>
        </span>
        <span class="active-tag" *ngIf="filters.priceRange">
          <i class="fas fa-dollar-sign"></i>
          {{ getPriceRangeLabel(filters.priceRange) }}
          <button (click)="clearPriceFilter()">
            <i class="fas fa-times"></i>
          </button>
        </span>
        <span class="active-tag" *ngFor="let size of filters.size">
          <i class="fas fa-ruler"></i>
          {{ size }}
          <button (click)="removeSizeFilter(size)">
            <i class="fas fa-times"></i>
          </button>
        </span>
        <span class="active-tag" *ngFor="let color of filters.color">
          <i class="fas fa-palette"></i>
          {{ color }}
          <button (click)="removeColorFilter(color)">
            <i class="fas fa-times"></i>
          </button>
        </span>
        <span class="active-tag" *ngFor="let brand of filters.brand">
          <i class="fas fa-crown"></i>
          {{ brand }}
          <button (click)="removeBrandFilter(brand)">
            <i class="fas fa-times"></i>
          </button>
        </span>
      </div>
    </div>
  </div>
</div>
